import{G as y,d as C,r as c,c as K,B as O,e as n,J as F,o as _,f as w,g as t,w as l,K as Q,m as h,i as v,k as V,q as W,H as m,L as X,_ as Y}from"./index-iq3_YIvd.js";const Z=(i,d)=>y.get(`/admin/product/baseTrademark/${i}/${d}`),ee=i=>i.id?y.put("/admin/product/baseTrademark/update",i):y.post("/admin/product/baseTrademark/save",i),ae=i=>y.delete(`/admin/product/baseTrademark/remove/${i}`),te={key:0},le=["src"],oe=["src"],re={class:"dialog-footer"},se=C({name:"Trademark"}),ne=C({...se,setup(i){const d=c(1),b=c(3),x=c(0),k=c([]),p=c(!1),U=c("添加品牌"),o=K({tmName:"",logoUrl:""}),u=c(),g=async(a=1)=>{d.value=a;const e=await Z(d.value,b.value);console.log(e,"服务器返回的数据res"),e.code===200&&(x.value=e.data.total,k.value=e.data.records)},T=()=>{var a,e;o.logoUrl="",o.tmName="",(a=u.value)==null||a.clearValidate("logoUrl"),(e=u.value)==null||e.clearValidate("tmName"),o.id=null,U.value="添加品牌",p.value=!0},B=a=>{var e,r;(e=u.value)==null||e.clearValidate("logoUrl"),(r=u.value)==null||r.clearValidate("tmName"),Object.assign(o,a),U.value="修改品牌",p.value=!0},$=a=>a.type=="image/png"||a.type=="image/jpeg"||a.type=="image/gif"?a.size/1024/1024<4?!0:(m({type:"error",message:"上传文件大小小于4M"}),!1):(m({type:"error",message:"上传文件格式务必PNG|JPG|GIF"}),!1),q=a=>{o.logoUrl=a.data,u.value.clearValidate("logoUrl")},z=async()=>{await u.value.validate(),(await ee(o)).code===200?(p.value=!1,m({type:"success",message:o.id?"修改成功":"添加成功"}),g(o.id?d.value:1)):m({type:"error",message:o.id?"修改失败":"修改成功"})},P={tmName:[{validator:(a,e,r)=>{e.trim().length>=2?r():r(new Error("名称长度必须大于5位"))},trigger:"blur",required:!0}],logoUrl:[{validator:(a,e,r)=>{e?r():r(new Error("请先上传图片"))},trigger:"blur",required:!0}]},E=a=>{X.confirm("确定删除吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{let e=await ae(a);e.code===200?(m({type:"success",message:"删除成功"}),g(k.value.length>1?d.value:d.value-1)):m({type:"error",message:e.data})}).catch(()=>{m({type:"info",message:"已取消删除"})})};return O(()=>{g()}),(a,e)=>{const r=n("el-button"),f=n("el-table-column"),G=n("el-table"),L=n("el-pagination"),M=n("el-card"),S=n("el-input"),N=n("el-form-item"),j=n("Plus"),D=n("el-icon"),R=n("el-upload"),A=n("el-form"),I=n("el-dialog"),J=F("has");return _(),w("div",null,[t(M,{class:"box-card"},{default:l(()=>[Q((_(),h(r,{type:"primary",icon:"Plus",onClick:T},{default:l(()=>[v(" 添加品牌 ")]),_:1})),[[J,"btn.Trademark.add"]]),t(G,{data:k.value,style:{margin:"10px 0"},border:""},{default:l(()=>[t(f,{prop:"date",label:"序号",width:"80px",align:"center",type:"index"}),t(f,{prop:"tmName",label:"品牌名称"}),t(f,{label:"Logo"},{default:l(s=>[s.row.logoUrl?(_(),w("span",te,[V("img",{src:s.row.logoUrl,alt:"",style:{width:"100px",height:"100px"}},null,8,le)])):W("",!0)]),_:1}),t(f,{label:"操作"},{default:l(s=>[t(r,{type:"primary",onClick:H=>B(s.row)},{default:l(()=>[v(" 编辑 ")]),_:2},1032,["onClick"]),t(r,{type:"danger",onClick:H=>E(s.row.id)},{default:l(()=>[v(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(L,{"current-page":d.value,"onUpdate:currentPage":e[0]||(e[0]=s=>d.value=s),"page-size":b.value,"onUpdate:pageSize":e[1]||(e[1]=s=>b.value=s),"page-sizes":[3,10],total:x.value,small:!0,background:"",layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:g,onSizeChange:g},null,8,["current-page","page-size","total"])]),_:1}),t(I,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=s=>p.value=s),title:U.value},{footer:l(()=>[V("span",re,[t(r,{onClick:e[3]||(e[3]=s=>p.value=!1)},{default:l(()=>[v("取消")]),_:1}),t(r,{type:"primary",onClick:z},{default:l(()=>[v("确定")]),_:1})])]),default:l(()=>[t(A,{style:{width:"80%"},model:o,rules:P,ref_key:"ruleFormRef",ref:u},{default:l(()=>[t(N,{label:"品牌名称","label-width":"100px",prop:"tmName"},{default:l(()=>[t(S,{placeholder:"请输入名称",modelValue:o.tmName,"onUpdate:modelValue":e[2]||(e[2]=s=>o.tmName=s)},null,8,["modelValue"])]),_:1}),t(N,{label:"Logo","label-width":"100px",prop:"logoUrl"},{default:l(()=>[t(R,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":q,"before-upload":$},{default:l(()=>[o.logoUrl?(_(),w("img",{key:0,src:o.logoUrl,class:"avatar"},null,8,oe)):(_(),h(D,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[t(j)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ce=Y(ne,[["__scopeId","data-v-b8f58306"]]);export{ce as default};
