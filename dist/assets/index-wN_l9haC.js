import{d as A,r as q,M as w,v as P,e as i,o as g,f as x,g as t,w as s,i as C,h as f,F as R,l as z,m as E,t as M,N as U,O as j,H as N,c as J,k as B,x as O,P as T,C as H,K as D,Q as F}from"./index-iq3_YIvd.js";function K(r){return{all:r=r||new Map,on:function(c,n){var a=r.get(c);a?a.push(n):r.set(c,[n])},off:function(c,n){var a=r.get(c);a&&(n?a.splice(a.indexOf(n)>>>0,1):r.set(c,[]))},emit:function(c,n){var a=r.get(c);a&&a.slice().map(function(e){e(n)}),(a=r.get("*"))&&a.slice().map(function(e){e(c,n)})}}}const V=K(),Q=A({__name:"sence0",emits:["changeSence"],setup(r,{emit:c}){const n=q([]),a=w(),e=c,k=()=>{e("changeSence"),V.emit("c3id",a.c3Id)},v=async()=>{const{c1Id:u,c2Id:l,c3Id:o}=a,d=await U(u,l,o);d.code===200&&(n.value=d.data)},$=u=>{console.log(u,"行信息"),e("changeSence"),V.emit("updateReqForm",u)},L=async u=>{(await j(u)).code===200?(N({type:"success",message:"删除成功"}),v()):N({type:"error",message:"删除失败"})};return V.on("updateList",()=>{v()}),P(()=>a.c3Id,()=>{if(n.value=[],!a.c3Id)return!1;v()}),(u,l)=>{const o=i("el-button"),d=i("el-table-column"),y=i("el-tag"),I=i("el-popconfirm"),_=i("el-table");return g(),x("div",null,[t(o,{type:"primary",icon:"Plus",style:{margin:"20px 0"},disabled:!f(a).c3Id,onClick:k},{default:s(()=>[C(" 添加属性 ")]),_:1},8,["disabled"]),t(_,{border:"",data:n.value},{default:s(()=>[t(d,{label:"序号",width:"100px",type:"index",align:"center"}),t(d,{label:"属性名称",prop:"attrName",width:"140px"}),t(d,{label:"属性值名称"},{default:s(({row:p})=>[(g(!0),x(R,null,z(p.attrValueList,b=>(g(),E(y,{key:b.id,style:{margin:"10px"}},{default:s(()=>[C(M(b.valueName),1)]),_:2},1024))),128))]),_:1}),t(d,{label:"操作",width:"140px"},{default:s(({row:p})=>[t(o,{type:"primary",size:"small",icon:"Edit",onClick:b=>$(p)},null,8,["onClick"]),t(I,{title:`确认删除属性名称${p.attrName}`,width:"200",onConfirm:b=>L(p.id)},{reference:s(()=>[t(o,{type:"danger",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])])}}}),Z=["onClick"],G=A({__name:"sence1",emits:["changeSence","cancel"],setup(r,{emit:c}){const n=c;let a=q([]),e=J({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3});const k=()=>{e.attrValueList.push({valueName:"",flag:!0}),O(()=>{a.value[e.attrValueList.length-1].focus()})},v=async()=>{const l=await T(e);console.log("属性保存的结果res",l),l.code===200?(n("changeSence"),V.emit("updateList"),N({type:"success",message:e.id?"修改成功":"添加成功"})):N({type:"error",message:e.id?"修改失败":"添加失败"})};V.on("c3id",l=>{console.log(l,"接收传递过来的参数"),Object.assign(e,{attrName:"",attrValueList:[],categoryId:l,categoryLevel:3})}),V.on("updateReqForm",l=>{Object.assign(e,JSON.parse(JSON.stringify(l)))});const $=(l,o)=>{if(l.valueName.trim()==="")return e.attrValueList.splice(o,1),N({type:"info",message:"属性值不能为空"}),!1;if(e.attrValueList.find(y=>{if(y!==l)return y.valueName===l.valueName}))return e.attrValueList.splice(o,1),N({type:"info",message:"属性值不能重复"}),!1;l.flag=!1},L=(l,o)=>{l.flag=!0,O(()=>{a.value[o].focus()})},u=(l,o)=>{a.value[o]=l};return(l,o)=>{const d=i("el-input"),y=i("el-form-item"),I=i("el-form"),_=i("el-button"),p=i("el-table-column"),b=i("el-table");return g(),x("div",null,[B("div",null,[t(I,{inline:""},{default:s(()=>[t(y,{label:"属性名称"},{default:s(()=>[t(d,{laceholder:"请输入名称",modelValue:f(e).attrName,"onUpdate:modelValue":o[0]||(o[0]=m=>f(e).attrName=m)},null,8,["modelValue"])]),_:1})]),_:1}),t(_,{type:"primary",icon:"Plus",disabled:!f(e).attrName,onClick:k},{default:s(()=>[C(" 添加属性值 ")]),_:1},8,["disabled"]),t(_,{type:"default",onClick:o[1]||(o[1]=m=>l.$emit("cancel"))},{default:s(()=>[C("取消")]),_:1}),t(b,{border:"",style:{margin:"20px 0"},data:f(e).attrValueList},{default:s(()=>[t(p,{label:"序号",width:"100px",type:"index",align:"center"}),t(p,{label:"属性值"},{default:s(({row:m,$index:S})=>[m.flag?(g(),E(d,{key:0,ref:h=>{u(h,S)},placeholder:"请输入属性值",modelValue:m.valueName,"onUpdate:modelValue":h=>m.valueName=h,onBlur:h=>$(m,S)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(g(),x("div",{key:1,onClick:h=>L(m,S)},M(m.valueName),9,Z))]),_:1}),t(p,{label:"操作"},{default:s(({scoped:m,index:S})=>[t(_,{type:"danger",size:"small",icon:"Delete",onClick:h=>f(e).attrValueList.splice(S,1)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),t(_,{type:"primary",onClick:v,disabled:f(e).attrValueList.length===0},{default:s(()=>[C(" 保存 ")]),_:1},8,["disabled"]),t(_,{type:"default",onClick:o[2]||(o[2]=m=>l.$emit("cancel"))},{default:s(()=>[C("取消")]),_:1})])])}}}),X=A({__name:"index",setup(r){const c=w(),n=q(0),a=()=>{n.value=0},e=()=>{n.value=1},k=()=>{n.value=0};return H(()=>{c.$reset()}),(v,$)=>{const L=i("Category"),u=i("el-card");return g(),x("div",null,[t(L,{sence:n.value},null,8,["sence"]),t(u,{style:{margin:"20px 0"}},{default:s(()=>[D(B("div",null,[t(Q,{onChangeSence:e})],512),[[F,n.value===0]]),D(B("div",null,[t(G,{onCancel:a,onChangeSence:k})],512),[[F,n.value===1]])]),_:1})])}}});export{X as default};
