import{G as p,d as U,r as y,c as $,B as j,e as d,o as E,f as G,g as e,w as t,i as u,t as L,h as r,z as g,H as w}from"./index-iq3_YIvd.js";const N=()=>p.get("/admin/acl/permission"),O=i=>i.id?p.put("/admin/acl/permission/update",i):p.post("/admin/acl/permission/save",i),T=i=>p.delete("/admin/acl/permission/remove/"+i),D=U({__name:"index",setup(i){let _=y([]),a=y(!1),n=$({code:"",level:0,name:"",pid:0});const f=async()=>{const o=await N();console.log(o,"获取菜单的数据"),o.code===200&&(_.value=o.data)},V=o=>{Object.assign(n,{code:"",level:0,name:"",pid:0,id:0}),a.value=!0,console.log(o),n.level=o.level+1,n.pid=o.id},C=o=>{a.value=!0,Object.assign(n,o)},k=async()=>{(await O(n)).code===200&&(w({type:"success",message:n.id?"更新成功":"添加成功"}),a.value=!1,f())},x=async o=>{(await T(o)).code===200&&(w({type:"success",message:"删除成功"}),f())};return j(()=>{f()}),(o,s)=>{const c=d("el-table-column"),m=d("el-button"),q=d("el-popconfirm"),M=d("el-table"),v=d("el-input"),b=d("el-form-item"),B=d("el-form"),R=d("el-dialog");return E(),G("div",null,[e(M,{style:{width:"100%"},"row-key":"id",border:"",data:r(_)},{default:t(()=>[e(c,{label:"名称",prop:"name"}),e(c,{label:"权限制",prop:"code"}),e(c,{label:"修改时间",prop:"updateTime"}),e(c,{label:"操作"},{default:t(l=>[e(m,{type:"primary",disabled:l.row.level===4,onClick:S=>V(l.row)},{default:t(()=>[u(L(l.row.level===3?"添加功能":"添加菜单"),1)]),_:2},1032,["disabled","onClick"]),e(m,{type:"primary",disabled:l.row.level===1,onClick:C},{default:t(()=>[u(" 编辑 ")]),_:2},1032,["disabled"]),e(q,{title:`确认删除${l.row.name}吗?`,width:"240",onConfirm:S=>x(l.row.id)},{reference:t(()=>[e(m,{type:"danger",disabled:l.row.level===1},{default:t(()=>[u(" 删除 ")]),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(R,{modelValue:r(a),"onUpdate:modelValue":s[3]||(s[3]=l=>g(a)?a.value=l:a=l),title:"添加菜单"},{footer:t(()=>[e(m,{onClick:s[2]||(s[2]=l=>g(a)?a.value=!1:a=!1)},{default:t(()=>[u("取消")]),_:1}),e(m,{type:"primary",onClick:k},{default:t(()=>[u("确定")]),_:1})]),default:t(()=>[e(B,{ref:"ruleFormRef"},{default:t(()=>[e(b,{label:"名称"},{default:t(()=>[e(v,{placeholder:"请输入名称",modelValue:r(n).name,"onUpdate:modelValue":s[0]||(s[0]=l=>r(n).name=l)},null,8,["modelValue"])]),_:1}),e(b,{label:"权限制"},{default:t(()=>[e(v,{placeholder:"请输入权限值",modelValue:r(n).code,"onUpdate:modelValue":s[1]||(s[1]=l=>r(n).code=l)},null,8,["modelValue"])]),_:1})]),_:1},512)]),_:1},8,["modelValue"])])}}});export{D as default};
